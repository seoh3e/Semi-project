# LeakRecord 팀 규격 (v1.0)

## 1. 목적

본 문서는 텔레그램 기반 유출·랜섬웨어·해킹 관련 피드 메시지를
**채널별 형식과 무관하게 하나의 표준 데이터 구조(LeakRecord)**로 통합하기 위한
**팀 공통 규격**을 정의한다.

본 프로젝트에서 생성되는 모든 분석·요약·OSINT 산출물은
본 문서에 정의된 LeakRecord 구조를 기준으로 한다.

---

## 2. LeakRecord 필드 규칙

### 2.1 필수 필드 (항상 채워야 함)

아래 필드는 **모든 LeakRecord에 반드시 포함**되어야 한다.

| 필드명                | 설명                                |
| ------------------ | --------------------------------- |
| `collected_at`     | 데이터 수집 날짜                         |
| `source`           | 텔레그램 채널 또는 수집 출처                  |
| `post_title`       | 게시글 제목 또는 메시지 요약                  |
| `confidence`       | 정보 신뢰도 (`high`, `medium`, `low`)  |
| `osint_seeds.urls` | 원문 또는 참고 URL 리스트 (없으면 빈 리스트 `[]`) |

> 위 필드 중 하나라도 누락될 경우 해당 데이터는 **유효한 LeakRecord로 간주하지 않는다.**

---

### 2.2 권장 필드 (가능하면 채움)

아래 필드는 원문 또는 파싱 결과가 존재할 경우 **채우는 것을 권장**한다.

| 필드명                | 설명                                   |
| ------------------ | ------------------------------------ |
| `posted_at`        | 게시 날짜                                |
| `target_service`   | 피해 조직 또는 서비스명                        |
| `threat_claim`     | 공격자 또는 랜섬웨어 그룹명                      |
| `domains`          | 관련 도메인 리스트                           |
| `leak_types`       | 유출 유형 (`ransomware`, `defacement` 등) |
| `estimated_volume` | 유출 데이터 규모                            |
| `file_formats`     | 파일 형식 정보                             |

> `target_service` 또는 `threat_claim` 중 **최소 하나는 채워지는 것을 목표**로 한다.

---

## 3. OSINT Seeds 규칙

`osint_seeds`는 OSINT 분석을 위한 **검색 및 참조용 씨앗 데이터**를 담는다.

### 필수 규칙

* `osint_seeds`는 반드시 존재해야 한다.
* `osint_seeds.urls`는 항상 리스트 형태로 포함되어야 한다.
* 모든 값은 **문자열 또는 문자열 리스트**만 허용한다.

### 권장 키

| 키            | 설명                              |
| ------------ | ------------------------------- |
| `urls`       | 원문·참조 URL                       |
| `keywords`   | OSINT 검색용 키워드                   |
| `references` | 외부 참고 자료                        |
| `ttps`       | MITRE ATT&CK Technique ID 또는 이름 |

---

## 4. Confidence 산정 기준

| 값        | 기준                           |
| -------- | ---------------------------- |
| `high`   | 타겟 + 공격자 + URL/도메인 정보가 모두 존재 |
| `medium` | 위 요소 중 2개 이상 존재              |
| `low`    | 정보가 제한적이거나 단편적인 경우           |

기본값은 `medium`으로 설정한다.

---

## 5. 누락 정보 처리 원칙

* 게시 날짜 파싱 실패는 허용하며 `posted_at = None`으로 둔다.
* URL이 없는 경우 `osint_seeds.urls = []`를 유지한다.
* 필수 필드가 누락된 경우 해당 데이터는 저장·요약 대상에서 제외할 수 있다.

---

## 6. 변경 관리

본 규격은 `LeakRecord v1.0`으로 정의한다.
필드 추가·변경은 팀 합의 후 버전 업데이트를 통해 진행한다.
